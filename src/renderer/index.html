<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self' https: data:;
    script-src 'self';
    style-src 'self' 'unsafe-inline';
    img-src 'self' data: https:;
    font-src 'self' https:;
    frame-src 'self' https: http: data: inspire:;
  ">
  <title>Jubilee</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <!-- Combined Title Bar with Tabs -->
    <header class="title-bar" id="titleBar">
      <!-- Tabs integrated into title bar -->
      <div class="tabs-container" id="tabsContainer">
        <!-- Tabs will be rendered here -->
        <button class="new-tab-btn" id="newTabBtn" title="New Tab">
          <svg width="12" height="12" viewBox="0 0 14 14">
            <path d="M7 1V13M1 7H13" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>

      <!-- Draggable area for moving window -->
      <div class="title-bar-drag-area" id="titleBarDragArea"></div>

      <div class="window-controls">
        <button class="window-btn" id="minimizeBtn" title="Minimize">
          <svg width="12" height="12" viewBox="0 0 12 12">
            <rect x="0" y="5" width="12" height="2" fill="currentColor"/>
          </svg>
        </button>
        <button class="window-btn" id="maximizeBtn" title="Maximize">
          <svg width="12" height="12" viewBox="0 0 12 12">
            <rect x="1" y="1" width="10" height="10" fill="none" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </button>
        <button class="window-btn close-btn" id="closeBtn" title="Close">
          <svg width="12" height="12" viewBox="0 0 12 12">
            <path d="M1 1L11 11M1 11L11 1" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Navigation Bar -->
    <div class="nav-bar" id="navBar">
      <div class="nav-controls">
        <button class="nav-btn" id="backBtn" title="Go Back" disabled>
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M10 2L4 8L10 14" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
        <button class="nav-btn" id="forwardBtn" title="Go Forward" disabled>
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M6 2L12 8L6 14" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
        <button class="nav-btn" id="reloadBtn" title="Reload">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M13.5 8A5.5 5.5 0 1 1 8 2.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M8 0L11 3L8 6" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </button>
      </div>

      <div class="address-container">
        <div class="mode-indicator" id="modeIndicator">
          <!-- Internet mode: globe icon, Jubilee Bibles mode: bible icon -->
          <svg class="internet-icon" width="16" height="16" viewBox="0 0 16 16">
            <circle cx="8" cy="8" r="6.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <ellipse cx="8" cy="8" rx="3" ry="6.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M1.5 8H14.5" stroke="currentColor" stroke-width="1.5"/>
            <path d="M2.5 4.5H13.5" stroke="currentColor" stroke-width="1"/>
            <path d="M2.5 11.5H13.5" stroke="currentColor" stroke-width="1"/>
          </svg>
          <img class="jubilee-icon" src="jubilee.png" alt="Jubilee" width="16" height="16">
        </div>
        <input
          type="text"
          class="address-bar"
          id="addressBar"
          placeholder="Enter address or search..."
          autocomplete="off"
          spellcheck="false"
        >
        <button class="bookmark-btn" id="bookmarkBtn" title="Bookmark this page">
          <svg class="bookmark-outline" width="16" height="16" viewBox="0 0 16 16">
            <path d="M8 2L9.5 5.5L13 6L10.5 8.5L11 12L8 10L5 12L5.5 8.5L3 6L6.5 5.5L8 2Z" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
          <svg class="bookmark-filled" width="16" height="16" viewBox="0 0 16 16">
            <path d="M8 2L9.5 5.5L13 6L10.5 8.5L11 12L8 10L5 12L5.5 8.5L3 6L6.5 5.5L8 2Z" stroke="currentColor" stroke-width="1.5" fill="currentColor"/>
          </svg>
        </button>
      </div>

      <button class="nav-btn" id="bibleBtn" title="Open Bible">
        <svg width="16" height="16" viewBox="0 0 16 16">
          <!-- Open book/bible shape -->
          <path d="M8 3C8 3 6 2 3 2C2 2 1 2.5 1 3.5V12.5C1 13.5 2 14 3 14C6 14 8 13 8 13M8 3C8 3 10 2 13 2C14 2 15 2.5 15 3.5V12.5C15 13.5 14 14 13 14C10 14 8 13 8 13M8 3V13" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          <!-- Cross on left page -->
          <path d="M4.5 5V9M3 7H6" stroke="currentColor" stroke-width="1" stroke-linecap="round"/>
        </svg>
      </button>

      <!-- Mode Toggle Switch -->
      <div class="mode-toggle-container">
        <span class="mode-toggle-label internet-label">Internet</span>
        <label class="mode-toggle">
          <input type="checkbox" id="modeToggle">
          <span class="mode-toggle-slider"></span>
        </label>
        <span class="mode-toggle-label jubileebibles-label">Jubilee Bibles</span>
      </div>

      <div class="nav-actions">
        <button class="nav-btn" id="historyBtn" title="History">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M8 4V8L11 10" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </button>
        <button class="nav-btn" id="bookmarksBtn" title="Bookmarks">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M3 2H13V14L8 10L3 14V2Z" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </button>
        <button class="nav-btn" id="settingsBtn" title="Settings">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <circle cx="8" cy="3" r="1.5" fill="currentColor"/>
            <circle cx="8" cy="8" r="1.5" fill="currentColor"/>
            <circle cx="8" cy="13" r="1.5" fill="currentColor"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Content Area with Webviews -->
    <main class="content-area" id="contentArea">
      <!-- Webviews for tabs will be rendered here -->
      <div class="welcome-message" id="welcomeMessage">
        <h1>Welcome to Jubilee</h1>
        <p>Toggle between Internet and Jubilee Bibles modes using the switch above.</p>
        <div class="mode-cards">
          <div class="mode-card internet-card">
            <h3>Internet Mode</h3>
            <p>Browse the public web normally</p>
          </div>
          <div class="mode-card jubileebibles-card">
            <h3>Jubilee Bibles Mode</h3>
            <p>Access .inspire locations</p>
          </div>
        </div>
      </div>
    </main>

    <!-- Side Panel (History/Bookmarks) -->
    <aside class="side-panel" id="sidePanel">
      <div class="side-panel-header">
        <h3 id="sidePanelTitle">History</h3>
        <button class="close-panel-btn" id="closePanelBtn">
          <svg width="14" height="14" viewBox="0 0 14 14">
            <path d="M1 1L13 13M1 13L13 1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>
      <div class="side-panel-content" id="sidePanelContent">
        <!-- Panel content will be rendered here -->
      </div>
    </aside>

    <!-- About Panel (Modal) -->
    <div class="about-modal" id="aboutModal">
      <div class="about-modal-content">
        <div class="about-modal-header">
          <h2>About Jubilee</h2>
          <button class="close-about-btn" id="closeAboutBtn">
            <svg width="14" height="14" viewBox="0 0 14 14">
              <path d="M1 1L13 13M1 13L13 1" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
        </div>
        <div class="about-modal-body">
          <div class="about-logo">
            <img src="jubilee.png" alt="Jubilee" width="64" height="64">
          </div>
          <div class="about-info">
            <h3>Jubilee Browser</h3>
            <p class="about-version" id="aboutVersion">Version 1.0.0</p>
            <p class="about-copyright">Copyright 2024 Jubilee Software, Inc.</p>
          </div>
          <div class="about-update-section" id="aboutUpdateSection">
            <div class="update-status" id="updateStatus">
              <span class="update-status-text" id="updateStatusText">Checking for updates...</span>
            </div>
            <div class="update-actions" id="updateActions">
              <button class="update-btn check-update-btn" id="checkUpdateBtn">Check for Updates</button>
              <button class="update-btn install-update-btn hidden" id="installUpdateBtn">Restart to Update</button>
            </div>
            <div class="update-details" id="updateDetails">
              <p class="update-channel" id="updateChannel">Channel: Stable</p>
              <p class="last-check-time" id="lastCheckTime">Last checked: Never</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Update notification badge (shown when update is ready) -->
    <div class="update-notification hidden" id="updateNotification">
      <span class="update-notification-text">Update ready</span>
      <button class="update-notification-btn" id="updateNotificationBtn">Restart</button>
      <button class="update-notification-dismiss" id="updateNotificationDismiss">
        <svg width="12" height="12" viewBox="0 0 12 12">
          <path d="M1 1L11 11M1 11L11 1" stroke="currentColor" stroke-width="1.5"/>
        </svg>
      </button>
    </div>

    <!-- Three-dot overflow menu (Chrome-style) -->
    <div class="overflow-menu" id="overflowMenu" role="menu" aria-label="Browser menu" tabindex="-1">
      <div class="menu-section">
        <button class="menu-item" id="menuNewTab" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <path d="M8 2v12M2 8h12" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
          </span>
          <span class="menu-label">New tab</span>
          <span class="menu-shortcut">Ctrl+T</span>
        </button>
        <button class="menu-item" id="menuNewWindow" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <rect x="2" y="3" width="12" height="10" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M2 6h12" stroke="currentColor" stroke-width="1"/>
            </svg>
          </span>
          <span class="menu-label">New window</span>
          <span class="menu-shortcut">Ctrl+N</span>
        </button>
        <button class="menu-item menu-item-jubilee" id="menuNewJubileeWindow" role="menuitem" tabindex="0">
          <span class="menu-icon jubilee-icon-menu">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <path d="M8 2C8 2 6 1 3 1C2 1 1 1.5 1 2.5V11.5C1 12.5 2 13 3 13C6 13 8 12 8 12M8 2C8 2 10 1 13 1C14 1 15 1.5 15 2.5V11.5C15 12.5 14 13 13 13C10 13 8 12 8 12M8 2V12" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M4.5 4V8M3 6H6" stroke="currentColor" stroke-width="1"/>
            </svg>
          </span>
          <span class="menu-label">New Jubilee Bible window</span>
          <span class="menu-shortcut">Ctrl+Shift+J</span>
        </button>
      </div>
      <div class="menu-divider"></div>
      <div class="menu-section">
        <button class="menu-item" id="menuHistory" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M8 4v4l3 2" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
          </span>
          <span class="menu-label">History</span>
          <span class="menu-shortcut">Ctrl+H</span>
        </button>
        <button class="menu-item" id="menuDownloads" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <path d="M8 2v8M4 7l4 4 4-4" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M2 12v2h12v-2" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
          </span>
          <span class="menu-label">Downloads</span>
          <span class="menu-shortcut">Ctrl+J</span>
        </button>
        <button class="menu-item" id="menuBookmarks" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <path d="M3 2h10v12l-5-3-5 3V2z" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
          </span>
          <span class="menu-label">Bookmarks</span>
          <span class="menu-shortcut">Ctrl+B</span>
        </button>
      </div>
      <div class="menu-divider"></div>
      <div class="menu-section">
        <div class="menu-item menu-zoom-controls" id="menuZoom" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <circle cx="7" cy="7" r="5" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M11 11l3 3" stroke="currentColor" stroke-width="1.5"/>
              <path d="M5 7h4M7 5v4" stroke="currentColor" stroke-width="1.5"/>
            </svg>
          </span>
          <span class="menu-label">Zoom</span>
          <div class="zoom-controls">
            <button class="zoom-btn" id="zoomOut" title="Zoom out">-</button>
            <span class="zoom-level" id="zoomLevel">100%</span>
            <button class="zoom-btn" id="zoomIn" title="Zoom in">+</button>
          </div>
        </div>
      </div>
      <div class="menu-divider"></div>
      <div class="menu-section">
        <button class="menu-item" id="menuPrint" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <rect x="3" y="8" width="10" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M4 8V2h8v6" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M5 11h6" stroke="currentColor" stroke-width="1"/>
            </svg>
          </span>
          <span class="menu-label">Print...</span>
          <span class="menu-shortcut">Ctrl+P</span>
        </button>
      </div>
      <div class="menu-divider"></div>
      <div class="menu-section">
        <button class="menu-item" id="menuSettings" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M8 1v2M8 13v2M1 8h2M13 8h2M2.9 2.9l1.4 1.4M11.7 11.7l1.4 1.4M2.9 13.1l1.4-1.4M11.7 4.3l1.4-1.4" stroke="currentColor" stroke-width="1.5"/>
            </svg>
          </span>
          <span class="menu-label">Settings</span>
        </button>
        <button class="menu-item" id="menuHelp" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M6 6c0-1.1.9-2 2-2s2 .9 2 2c0 1.5-2 1.5-2 3" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <circle cx="8" cy="12" r="0.5" fill="currentColor"/>
            </svg>
          </span>
          <span class="menu-label">Help</span>
          <span class="menu-shortcut">F1</span>
        </button>
        <button class="menu-item" id="menuAbout" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M8 5v1M8 8v4" stroke="currentColor" stroke-width="1.5"/>
            </svg>
          </span>
          <span class="menu-label">About Jubilee</span>
        </button>
      </div>
      <div class="menu-divider"></div>
      <div class="menu-section">
        <button class="menu-item menu-item-exit" id="menuExit" role="menuitem" tabindex="0">
          <span class="menu-icon">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <path d="M6 2H3a1 1 0 00-1 1v10a1 1 0 001 1h3M11 12l3-4-3-4M6 8h8" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
          </span>
          <span class="menu-label">Exit</span>
          <span class="menu-shortcut">Alt+F4</span>
        </button>
      </div>
    </div>

    <!-- Jubilee Bible Window indicator badge -->
    <div class="jubilee-window-badge hidden" id="jubileeWindowBadge">
      <svg width="14" height="14" viewBox="0 0 16 16">
        <path d="M8 2C8 2 6 1 3 1C2 1 1 1.5 1 2.5V11.5C1 12.5 2 13 3 13C6 13 8 12 8 12M8 2C8 2 10 1 13 1C14 1 15 1.5 15 2.5V11.5C15 12.5 14 13 13 13C10 13 8 12 8 12M8 2V12" stroke="currentColor" stroke-width="1.5" fill="none"/>
      </svg>
      <span>Jubilee Bible</span>
    </div>

    <!-- Tab Context Menu (Chrome-style right-click menu) -->
    <div class="tab-context-menu" id="tabContextMenu" role="menu" aria-label="Tab options">
      <button class="context-menu-item" id="ctxNewTab" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M8 2v12M2 8h12" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </span>
        <span class="context-menu-label">New tab</span>
      </button>
      <div class="context-menu-divider"></div>
      <button class="context-menu-item" id="ctxReload" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M13.5 8A5.5 5.5 0 1 1 8 2.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M8 0L11 3L8 6" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </span>
        <span class="context-menu-label">Reload</span>
      </button>
      <button class="context-menu-item" id="ctxDuplicate" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <rect x="4" y="4" width="9" height="9" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M3 12V3h9" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </span>
        <span class="context-menu-label">Duplicate</span>
      </button>
      <button class="context-menu-item" id="ctxPin" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M10 2L14 6L9 11L5 11L5 7L10 2Z" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M5 11L2 14" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <span class="context-menu-label" id="ctxPinLabel">Pin</span>
      </button>
      <button class="context-menu-item" id="ctxMute" role="menuitem" tabindex="0">
        <span class="context-menu-icon" id="ctxMuteIcon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M8 2L4 6H1v4h3l4 4V2z" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M12 6l4 4M16 6l-4 4" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <span class="context-menu-label" id="ctxMuteLabel">Mute site</span>
      </button>
      <div class="context-menu-divider"></div>
      <button class="context-menu-item context-menu-submenu" id="ctxAddToGroup" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <rect x="1" y="3" width="14" height="3" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <rect x="1" y="10" width="14" height="3" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </span>
        <span class="context-menu-label">Add tab to group</span>
        <span class="context-menu-arrow">
          <svg width="8" height="8" viewBox="0 0 8 8">
            <path d="M2 1l4 3-4 3" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </span>
      </button>
      <button class="context-menu-item hidden" id="ctxRemoveFromGroup" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M4 8h8" stroke="currentColor" stroke-width="1.5"/>
            <rect x="1" y="3" width="14" height="10" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </span>
        <span class="context-menu-label">Remove from group</span>
      </button>
      <div class="context-menu-divider"></div>
      <button class="context-menu-item" id="ctxMoveToNewWindow" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <rect x="1" y="3" width="10" height="8" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M5 6h6" stroke="currentColor" stroke-width="1"/>
            <path d="M11 8l4-4M15 4v3M12 4h3" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <span class="context-menu-label">Move tab to new window</span>
      </button>
      <div class="context-menu-divider"></div>
      <button class="context-menu-item" id="ctxCloseTab" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M3 3l10 10M13 3L3 13" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <span class="context-menu-label">Close</span>
      </button>
      <button class="context-menu-item" id="ctxCloseOthers" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <rect x="5" y="5" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M2 2l3 3M14 2l-3 3M2 14l3-3M14 14l-3-3" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <span class="context-menu-label">Close other tabs</span>
      </button>
      <button class="context-menu-item" id="ctxCloseToRight" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <rect x="2" y="4" width="4" height="8" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M10 5l4 3-4 3" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M10 8h4" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <span class="context-menu-label">Close tabs to the right</span>
      </button>
      <div class="context-menu-divider"></div>
      <button class="context-menu-item" id="ctxReopenClosed" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M2 8a6 6 0 1 1 6 6" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M2 4v4h4" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </span>
        <span class="context-menu-label">Reopen closed tab</span>
        <span class="context-menu-shortcut">Ctrl+Shift+T</span>
      </button>
    </div>

    <!-- Tab Group Submenu -->
    <div class="tab-group-submenu" id="tabGroupSubmenu" role="menu" aria-label="Tab groups">
      <button class="context-menu-item" id="groupNewGroup" role="menuitem" tabindex="0">
        <span class="context-menu-icon">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M8 4v8M4 8h8" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <span class="context-menu-label">New group</span>
      </button>
      <div class="context-menu-divider group-divider hidden" id="groupDivider"></div>
      <div class="existing-groups" id="existingGroups">
        <!-- Existing groups will be rendered here dynamically -->
      </div>
    </div>

    <!-- New Group Color Picker -->
    <div class="new-group-picker" id="newGroupPicker" role="dialog" aria-label="Create new group">
      <div class="group-picker-header">
        <input type="text" class="group-name-input" id="groupNameInput" placeholder="Name group" maxlength="20">
      </div>
      <div class="group-color-picker">
        <button class="group-color-btn" data-color="grey" title="Grey" style="background-color: #5f6368;"></button>
        <button class="group-color-btn" data-color="blue" title="Blue" style="background-color: #1a73e8;"></button>
        <button class="group-color-btn" data-color="red" title="Red" style="background-color: #d93025;"></button>
        <button class="group-color-btn" data-color="yellow" title="Yellow" style="background-color: #f9ab00;"></button>
        <button class="group-color-btn" data-color="green" title="Green" style="background-color: #188038;"></button>
        <button class="group-color-btn" data-color="pink" title="Pink" style="background-color: #e91e63;"></button>
        <button class="group-color-btn" data-color="purple" title="Purple" style="background-color: #9334e6;"></button>
        <button class="group-color-btn" data-color="cyan" title="Cyan" style="background-color: #00bcd4;"></button>
        <button class="group-color-btn" data-color="orange" title="Orange" style="background-color: #fa903e;"></button>
      </div>
    </div>

    <!-- ============================================
         Sign-In Modal
         Jubilee Identity sign-in interface
         ============================================ -->
    <div class="sign-in-modal" id="signInModal" role="dialog" aria-labelledby="signInTitle" aria-modal="true">
      <div class="sign-in-modal-content">
        <div class="sign-in-header">
          <div class="sign-in-logo">
            <img src="assets/icon.png" alt="Jubilee" width="48" height="48">
          </div>
          <h2 id="signInTitle">Sign in to Jubilee</h2>
          <p class="sign-in-subtitle" id="signInSubtitle">Access Round Table, saved notes, and more</p>
          <button class="close-sign-in-btn" id="closeSignInBtn" aria-label="Close">
            <svg width="20" height="20" viewBox="0 0 20 20">
              <path d="M4 4l12 12M16 4L4 16" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
        </div>

        <div class="sign-in-body">
          <!-- Sign-in form -->
          <form class="sign-in-form" id="signInForm">
            <div class="form-group">
              <label for="signInEmail">Email address</label>
              <input type="email" id="signInEmail" name="email" placeholder="your@email.com" required autocomplete="email">
            </div>

            <div class="form-group" id="passwordGroup">
              <label for="signInPassword">Password</label>
              <input type="password" id="signInPassword" name="password" placeholder="Enter your password" autocomplete="current-password">
            </div>

            <div class="sign-in-error hidden" id="signInError">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <path d="M8 4v5M8 11v1" stroke="currentColor" stroke-width="1.5"/>
              </svg>
              <span id="signInErrorText"></span>
            </div>

            <button type="submit" class="sign-in-btn primary" id="signInSubmitBtn">
              <span class="btn-text">Sign in</span>
              <span class="btn-loading hidden">
                <svg class="spinner" width="18" height="18" viewBox="0 0 18 18">
                  <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="44" stroke-dashoffset="11"/>
                </svg>
              </span>
            </button>
          </form>

          <div class="sign-in-divider">
            <span>or</span>
          </div>

          <button class="sign-in-btn magic-link" id="magicLinkBtn">
            <svg width="18" height="18" viewBox="0 0 18 18">
              <path d="M3 9h12M11 5l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
            <span>Sign in with magic link</span>
          </button>

          <p class="sign-in-footer">
            Don't have an account? <a href="#" id="createAccountLink">Create one</a>
          </p>
        </div>

        <!-- Magic link sent confirmation -->
        <div class="magic-link-sent hidden" id="magicLinkSent">
          <div class="magic-link-icon">
            <svg width="48" height="48" viewBox="0 0 48 48">
              <circle cx="24" cy="24" r="20" stroke="currentColor" stroke-width="2" fill="none"/>
              <path d="M14 24l7 7 13-13" stroke="currentColor" stroke-width="2.5" fill="none"/>
            </svg>
          </div>
          <h3>Check your email</h3>
          <p>We sent a sign-in link to <strong id="magicLinkEmail"></strong></p>
          <button class="sign-in-btn secondary" id="backToSignInBtn">Back to sign in</button>
        </div>
      </div>
    </div>

    <!-- ============================================
         Profile Panel (Slide-out)
         Shows when user clicks profile avatar
         ============================================ -->
    <div class="profile-panel" id="profilePanel">
      <div class="profile-panel-header">
        <div class="profile-avatar" id="profilePanelAvatar">
          <span id="profilePanelInitial">J</span>
        </div>
        <div class="profile-info">
          <div class="profile-name" id="profilePanelName">Jubilee User</div>
          <div class="profile-email" id="profilePanelEmail">user@example.com</div>
        </div>
        <button class="close-profile-btn" id="closeProfileBtn" aria-label="Close">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M3 3l10 10M13 3L3 13" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </button>
      </div>

      <div class="profile-panel-body">
        <div class="profile-section">
          <h4>Account</h4>
          <button class="profile-menu-item" id="profileManageBtn">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <circle cx="8" cy="5" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M2 14c0-3 2.5-5 6-5s6 2 6 5" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
            <span>Manage account</span>
          </button>
          <button class="profile-menu-item" id="profileSyncBtn">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <path d="M2 8a6 6 0 0 1 10-4.5M14 8a6 6 0 0 1-10 4.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M12 1v4h-4M4 15v-4h4" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
            <span>Sync settings</span>
          </button>
        </div>

        <div class="profile-section">
          <h4>Jubilee Services</h4>
          <button class="profile-menu-item" id="profileRoundTableBtn">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
            <span>Round Table</span>
          </button>
          <button class="profile-menu-item" id="profileNotesBtn">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <rect x="2" y="2" width="12" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M4 5h8M4 8h6M4 11h4" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <span>Saved notes</span>
          </button>
        </div>
      </div>

      <div class="profile-panel-footer">
        <button class="sign-out-btn" id="signOutBtn">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <path d="M6 2H3a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h3M11 11l3-3-3-3M5 8h9" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
          <span>Sign out</span>
        </button>
      </div>
    </div>

    <!-- Profile button in nav bar (shown when authenticated) -->
    <!-- This will be dynamically added to the nav-actions area -->
  </div>

  <script src="renderer.js"></script>
</body>
</html>
